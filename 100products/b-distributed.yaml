# This file was generated by "weaver kube" version v0.24.8 for the following
# application:
#
#     app: bookinfo-serviceweaver
#     version: bc9018f3
#     components groups:
#     - 
#       - github.com/ServiceWeaver/weaver/Main
#     - 
#       - github.com/camilamedeir0s/bookinfo-serviceweaver/details/Details
#     - 
#       - github.com/camilamedeir0s/bookinfo-serviceweaver/ratings/Ratings
#     - 
#       - github.com/camilamedeir0s/bookinfo-serviceweaver/reviews/Reviews
#     listeners:
#     - productpage
#
# This file contains the following resources:
#
#     1. A Deployment for every group of components.
#     2. A HorizontalPodAutoscaler for every Deployment.
#     3. A Service for every listener.
#     4. Some Roles and RoleBindings to configure permissions.
#
# To deploy these resources, run:
#
#     kubectl apply -f /tmp/kube_bc9018f3.yaml
#
# To view the deployed resources, run:
#
#     kubectl get all,configmaps --selector=serviceweaver/version=bc9018f3
#
# To view a description of every resource, run:
#
#     kubectl get all,configmaps --selector=serviceweaver/version=bc9018f3 -o custom-columns=KIND:.kind,NAME:.metadata.name,APP:.metadata.labels.serviceweaver/app,VERSION:.metadata.labels.serviceweaver/version,DESCRIPTION:.metadata.annotations.description
#
# To delete the resources, run:
#
#     kubectl delete all,configmaps --selector=serviceweaver/version=bc9018f3


# Roles.
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  creationTimestamp: null
  name: serviceweaver-pods-getter
  namespace: default
rules:
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - get
  - list
  - watch

---

# Role Bindings.
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  creationTimestamp: null
  name: serviceweaver-default-pods-getter
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: serviceweaver-pods-getter
subjects:
- kind: ServiceAccount
  name: default
  namespace: default

---

# Configuration
apiVersion: v1
data:
  config.textpb: |
    namespace:  "default"
    deployment_id:  "bc9018f3-2e92-4b35-84e6-d755f83a6308"
    listeners:  {
      key:  "productpage"
      value:  20000
    }
    groups:  {
      key:  "github.com/ServiceWeaver/weaver/Main"
      value:  "github.com/ServiceWeaver/weaver/Main"
    }
    groups:  {
      key:  "github.com/camilamedeir0s/bookinfo-serviceweaver/details/Details"
      value:  "github.com/camilamedeir0s/bookinfo-serviceweaver/details/Details"
    }
    groups:  {
      key:  "github.com/camilamedeir0s/bookinfo-serviceweaver/ratings/Ratings"
      value:  "github.com/camilamedeir0s/bookinfo-serviceweaver/ratings/Ratings"
    }
    groups:  {
      key:  "github.com/camilamedeir0s/bookinfo-serviceweaver/reviews/Reviews"
      value:  "github.com/camilamedeir0s/bookinfo-serviceweaver/reviews/Reviews"
    }
    telemetry:  {
      metrics:  {
        export_interval:  {
          seconds:  30
        }
      }
    }
  weaver.toml: "[serviceweaver]\r\nbinary = \"./bookinfo-serviceweaver\"\r\nrollout
    = \"5m\"\r\n\r\n[single]\r\nlisteners.productpage = {address = \"localhost:12345\"}\r\n\r\n[multi]\r\nlisteners.productpage
    = {address = \"localhost:12345\"}"
kind: ConfigMap
metadata:
  annotations:
    description: This ConfigMap contains config files for app "bookinfo-serviceweaver"
      version "bc9018f3".
  creationTimestamp: null
  labels:
    serviceweaver/app: bookinfo-serviceweaver
    serviceweaver/version: bc9018f3
  name: config-bc9018f3
  namespace: default

---

# Listener Service for group github.com/ServiceWeaver/weaver/Main
apiVersion: v1
kind: Service
metadata:
  annotations:
    description: This Service forwards traffic to the "productpage" listener.
  creationTimestamp: null
  labels:
    serviceweaver/app: bookinfo-serviceweaver
    serviceweaver/listener: productpage
    serviceweaver/version: bc9018f3
  name: productpage-bc9018f3
  namespace: default
spec:
  ports:
  - port: 80
    protocol: TCP
    targetPort: 20000
  selector:
    serviceweaver/name: bookinfo-serviceweaver-weaver-main-bc9018f3-7e3ccffa
  type: LoadBalancer
status:
  loadBalancer: {}

---

# Deployment for group github.com/ServiceWeaver/weaver/Main
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    description: This Deployment hosts components github.com/ServiceWeaver/weaver/Main.
  creationTimestamp: null
  labels:
    serviceweaver/app: bookinfo-serviceweaver
    serviceweaver/version: bc9018f3
  name: bookinfo-serviceweaver-weaver-main-bc9018f3-7e3ccffa
  namespace: default
spec:
  selector:
    matchLabels:
      serviceweaver/name: bookinfo-serviceweaver-weaver-main-bc9018f3-7e3ccffa
  strategy: {}
  template:
    metadata:
      annotations:
        description: This Pod hosts components github.com/ServiceWeaver/weaver/Main.
      creationTimestamp: null
      labels:
        serviceweaver/app: bookinfo-serviceweaver
        serviceweaver/name: bookinfo-serviceweaver-weaver-main-bc9018f3-7e3ccffa
        serviceweaver/version: bc9018f3
      namespace: default
    spec:
      # affinity:
      #   podAntiAffinity:
      #     preferredDuringSchedulingIgnoredDuringExecution:
      #     - podAffinityTerm:
      #         labelSelector:
      #           matchLabels:
      #             serviceweaver/name: bookinfo-serviceweaver-weaver-main-bc9018f3-7e3ccffa
      #         topologyKey: kubernetes.io/hostname
      #       weight: 100
      nodeSelector:
        name: node01
      containers:
      - args:
        - babysitter
        - /weaver/weaver.toml
        - /weaver/config.textpb
        - github.com/ServiceWeaver/weaver/Main
        image: docker.io/camilamedeir0s/bookinfo-serviceweaver:bc9018f3
        imagePullPolicy: IfNotPresent
        name: serviceweaver
        ports:
        - containerPort: 20000
          name: productpage
        resources: {}
        stdin: true
        tty: true
        volumeMounts:
        - mountPath: /weaver/weaver.toml
          name: config
          subPath: weaver.toml
        - mountPath: /weaver/config.textpb
          name: config
          subPath: config.textpb
      dnsPolicy: ClusterFirst
      serviceAccountName: default
      volumes:
      - configMap:
          name: config-bc9018f3
        name: config
status: {}

---

# Autoscaler for group github.com/ServiceWeaver/weaver/Main
# apiVersion: autoscaling/v2
# kind: HorizontalPodAutoscaler
# metadata:
#   annotations:
#     description: This HorizontalPodAutoscaler scales the "bookinfo-serviceweaver-weaver-main-bc9018f3-7e3ccffa"
#       Deployment.
#   creationTimestamp: null
#   labels:
#     serviceweaver/app: bookinfo-serviceweaver
#     serviceweaver/version: bc9018f3
#   name: bookinfo-serviceweaver-weaver-main-bc9018f3-7e3ccffa
#   namespace: default
# spec:
#   maxReplicas: 10
#   metrics:
#   - resource:
#       name: cpu
#       target:
#         averageUtilization: 80
#         type: Utilization
#     type: Resource
#   minReplicas: 1
#   scaleTargetRef:
#     apiVersion: apps/v1
#     kind: Deployment
#     name: bookinfo-serviceweaver-weaver-main-bc9018f3-7e3ccffa
# status:
#   currentMetrics: null
#   desiredReplicas: 0

# ---

# Deployment for group github.com/camilamedeir0s/bookinfo-serviceweaver/details/Details
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    description: This Deployment hosts components github.com/camilamedeir0s/bookinfo-serviceweaver/details/Details.
  creationTimestamp: null
  labels:
    serviceweaver/app: bookinfo-serviceweaver
    serviceweaver/version: bc9018f3
  name: bookinfo-serviceweaver-details-details-bc9018f3-e3beeea3
  namespace: default
spec:
  selector:
    matchLabels:
      serviceweaver/name: bookinfo-serviceweaver-details-details-bc9018f3-e3beeea3
  strategy: {}
  template:
    metadata:
      annotations:
        description: This Pod hosts components github.com/camilamedeir0s/bookinfo-serviceweaver/details/Details.
      creationTimestamp: null
      labels:
        serviceweaver/app: bookinfo-serviceweaver
        serviceweaver/name: bookinfo-serviceweaver-details-details-bc9018f3-e3beeea3
        serviceweaver/version: bc9018f3
      namespace: default
    spec:
      # affinity:
      #   podAntiAffinity:
      #     preferredDuringSchedulingIgnoredDuringExecution:
      #     - podAffinityTerm:
      #         labelSelector:
      #           matchLabels:
      #             serviceweaver/name: bookinfo-serviceweaver-details-details-bc9018f3-e3beeea3
      #         topologyKey: kubernetes.io/hostname
      #       weight: 100
      nodeSelector:
        name: node01
      containers:
      - args:
        - babysitter
        - /weaver/weaver.toml
        - /weaver/config.textpb
        - github.com/camilamedeir0s/bookinfo-serviceweaver/details/Details
        image: docker.io/camilamedeir0s/bookinfo-serviceweaver:bc9018f3
        imagePullPolicy: IfNotPresent
        name: serviceweaver
        resources: {}
        stdin: true
        tty: true
        volumeMounts:
        - mountPath: /weaver/weaver.toml
          name: config
          subPath: weaver.toml
        - mountPath: /weaver/config.textpb
          name: config
          subPath: config.textpb
      dnsPolicy: ClusterFirst
      serviceAccountName: default
      volumes:
      - configMap:
          name: config-bc9018f3
        name: config
status: {}

---

# Autoscaler for group github.com/camilamedeir0s/bookinfo-serviceweaver/details/Details
# apiVersion: autoscaling/v2
# kind: HorizontalPodAutoscaler
# metadata:
#   annotations:
#     description: This HorizontalPodAutoscaler scales the "bookinfo-serviceweaver-details-details-bc9018f3-e3beeea3"
#       Deployment.
#   creationTimestamp: null
#   labels:
#     serviceweaver/app: bookinfo-serviceweaver
#     serviceweaver/version: bc9018f3
#   name: bookinfo-serviceweaver-details-details-bc9018f3-e3beeea3
#   namespace: default
# spec:
#   maxReplicas: 10
#   metrics:
#   - resource:
#       name: cpu
#       target:
#         averageUtilization: 80
#         type: Utilization
#     type: Resource
#   minReplicas: 1
#   scaleTargetRef:
#     apiVersion: apps/v1
#     kind: Deployment
#     name: bookinfo-serviceweaver-details-details-bc9018f3-e3beeea3
# status:
#   currentMetrics: null
#   desiredReplicas: 0

# ---

# Deployment for group github.com/camilamedeir0s/bookinfo-serviceweaver/ratings/Ratings
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    description: This Deployment hosts components github.com/camilamedeir0s/bookinfo-serviceweaver/ratings/Ratings.
  creationTimestamp: null
  labels:
    serviceweaver/app: bookinfo-serviceweaver
    serviceweaver/version: bc9018f3
  name: bookinfo-serviceweaver-ratings-ratings-bc9018f3-67ca4b3e
  namespace: default
spec:
  selector:
    matchLabels:
      serviceweaver/name: bookinfo-serviceweaver-ratings-ratings-bc9018f3-67ca4b3e
  strategy: {}
  template:
    metadata:
      annotations:
        description: This Pod hosts components github.com/camilamedeir0s/bookinfo-serviceweaver/ratings/Ratings.
      creationTimestamp: null
      labels:
        serviceweaver/app: bookinfo-serviceweaver
        serviceweaver/name: bookinfo-serviceweaver-ratings-ratings-bc9018f3-67ca4b3e
        serviceweaver/version: bc9018f3
      namespace: default
    spec:
      # affinity:
      #   podAntiAffinity:
      #     preferredDuringSchedulingIgnoredDuringExecution:
      #     - podAffinityTerm:
      #         labelSelector:
      #           matchLabels:
      #             serviceweaver/name: bookinfo-serviceweaver-ratings-ratings-bc9018f3-67ca4b3e
      #         topologyKey: kubernetes.io/hostname
      #       weight: 100
      nodeSelector:
        name: node01
      containers:
      - args:
        - babysitter
        - /weaver/weaver.toml
        - /weaver/config.textpb
        - github.com/camilamedeir0s/bookinfo-serviceweaver/ratings/Ratings
        image: docker.io/camilamedeir0s/bookinfo-serviceweaver:bc9018f3
        imagePullPolicy: IfNotPresent
        name: serviceweaver
        resources: {}
        stdin: true
        tty: true
        volumeMounts:
        - mountPath: /weaver/weaver.toml
          name: config
          subPath: weaver.toml
        - mountPath: /weaver/config.textpb
          name: config
          subPath: config.textpb
      dnsPolicy: ClusterFirst
      serviceAccountName: default
      volumes:
      - configMap:
          name: config-bc9018f3
        name: config
status: {}

---

# Autoscaler for group github.com/camilamedeir0s/bookinfo-serviceweaver/ratings/Ratings
# apiVersion: autoscaling/v2
# kind: HorizontalPodAutoscaler
# metadata:
#   annotations:
#     description: This HorizontalPodAutoscaler scales the "bookinfo-serviceweaver-ratings-ratings-bc9018f3-67ca4b3e"
#       Deployment.
#   creationTimestamp: null
#   labels:
#     serviceweaver/app: bookinfo-serviceweaver
#     serviceweaver/version: bc9018f3
#   name: bookinfo-serviceweaver-ratings-ratings-bc9018f3-67ca4b3e
#   namespace: default
# spec:
#   maxReplicas: 10
#   metrics:
#   - resource:
#       name: cpu
#       target:
#         averageUtilization: 80
#         type: Utilization
#     type: Resource
#   minReplicas: 1
#   scaleTargetRef:
#     apiVersion: apps/v1
#     kind: Deployment
#     name: bookinfo-serviceweaver-ratings-ratings-bc9018f3-67ca4b3e
# status:
#   currentMetrics: null
#   desiredReplicas: 0

# ---

# Deployment for group github.com/camilamedeir0s/bookinfo-serviceweaver/reviews/Reviews
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    description: This Deployment hosts components github.com/camilamedeir0s/bookinfo-serviceweaver/reviews/Reviews.
  creationTimestamp: null
  labels:
    serviceweaver/app: bookinfo-serviceweaver
    serviceweaver/version: bc9018f3
  name: bookinfo-serviceweaver-reviews-reviews-bc9018f3-6be73a83
  namespace: default
spec:
  selector:
    matchLabels:
      serviceweaver/name: bookinfo-serviceweaver-reviews-reviews-bc9018f3-6be73a83
  strategy: {}
  template:
    metadata:
      annotations:
        description: This Pod hosts components github.com/camilamedeir0s/bookinfo-serviceweaver/reviews/Reviews.
      creationTimestamp: null
      labels:
        serviceweaver/app: bookinfo-serviceweaver
        serviceweaver/name: bookinfo-serviceweaver-reviews-reviews-bc9018f3-6be73a83
        serviceweaver/version: bc9018f3
      namespace: default
    spec:
      # affinity:
      #   podAntiAffinity:
      #     preferredDuringSchedulingIgnoredDuringExecution:
      #     - podAffinityTerm:
      #         labelSelector:
      #           matchLabels:
      #             serviceweaver/name: bookinfo-serviceweaver-reviews-reviews-bc9018f3-6be73a83
      #         topologyKey: kubernetes.io/hostname
      #       weight: 100
      nodeSelector:
        name: node01
      containers:
      - args:
        - babysitter
        - /weaver/weaver.toml
        - /weaver/config.textpb
        - github.com/camilamedeir0s/bookinfo-serviceweaver/reviews/Reviews
        image: docker.io/camilamedeir0s/bookinfo-serviceweaver:bc9018f3
        imagePullPolicy: IfNotPresent
        name: serviceweaver
        resources: {}
        stdin: true
        tty: true
        volumeMounts:
        - mountPath: /weaver/weaver.toml
          name: config
          subPath: weaver.toml
        - mountPath: /weaver/config.textpb
          name: config
          subPath: config.textpb
      dnsPolicy: ClusterFirst
      serviceAccountName: default
      volumes:
      - configMap:
          name: config-bc9018f3
        name: config
status: {}

---

# Autoscaler for group github.com/camilamedeir0s/bookinfo-serviceweaver/reviews/Reviews
# apiVersion: autoscaling/v2
# kind: HorizontalPodAutoscaler
# metadata:
#   annotations:
#     description: This HorizontalPodAutoscaler scales the "bookinfo-serviceweaver-reviews-reviews-bc9018f3-6be73a83"
#       Deployment.
#   creationTimestamp: null
#   labels:
#     serviceweaver/app: bookinfo-serviceweaver
#     serviceweaver/version: bc9018f3
#   name: bookinfo-serviceweaver-reviews-reviews-bc9018f3-6be73a83
#   namespace: default
# spec:
#   maxReplicas: 10
#   metrics:
#   - resource:
#       name: cpu
#       target:
#         averageUtilization: 80
#         type: Utilization
#     type: Resource
#   minReplicas: 1
#   scaleTargetRef:
#     apiVersion: apps/v1
#     kind: Deployment
#     name: bookinfo-serviceweaver-reviews-reviews-bc9018f3-6be73a83
# status:
#   currentMetrics: null
#   desiredReplicas: 0

# ---
